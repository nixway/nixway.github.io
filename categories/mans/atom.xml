<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Категория: Mans | Путь юниксоида]]></title>
  <link href="http://nixway.org/categories/mans/atom.xml" rel="self"/>
  <link href="http://nixway.org/"/>
  <updated>2016-08-14T17:34:34+06:00</updated>
  <id>http://nixway.org/</id>
  <author>
    <name><![CDATA[nihi1ist]]></name>
    <email><![CDATA[nihi1ist@nixway.org]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Особенности доступа к файлам и каталогам в UNIX-подобных ОС]]></title>
    <link href="http://nixway.org/mans/osobiennosti-dostupa-k-failam-i-katalogam-v-unix-podobnykh-os/"/>
    <updated>2015-04-14T23:26:32+06:00</updated>
    <id>http://nixway.org/mans/osobiennosti-dostupa-k-failam-i-katalogam-v-unix-podobnykh-os</id>
    <content type="html"><![CDATA[<p><img src="/images/posts/2015-04-14/features-access-to-files-and-directories-in-nix.png" alt="Features access to files &amp; directories in *nix" /></p>

<p><em>В данной статье рассказ пойдёт о особенностях доступа к файлам и каталогам в UNIX-подобных операционных системах. Думаю статья будет полезна многим пользователям впервые столкнувшимся с UNIX-подобной операционной системой (к которой относится тот же Linux). Особенно, если пользователь до этого имел дело только с операционными системами Windows.</em></p>

<!--more-->


<h2>Теория.</h2>

<p>Поскольку любая UNIX-подобная операционная система — система многопользовательская, вопрос об организации разграничения доступа к файлам и каталогам является одним из существенных вопросов, которые должна решать операционная система. Механизмы разграничения доступа, разработанные для системы UNIX в 70-х годах (возможно, впрочем, они предлагались кем-то и раньше), очень просты, но они оказались настолько эффективными, что просуществовали уже более 30 лет и по сей день успешно выполняют стоящие перед ними задачи.</p>

<p>В основе механизмов разграничения доступа лежат имена пользователей и имена групп пользователей. Вы уже знаете, что в *nix каждый пользователь имеет уникальное имя, под которым он входит в систему (авторизуется). Кроме того, в системе создается некоторое число групп пользователей, причем каждый пользователь может быть включен в одну или несколько групп. Создает и удаляет группы суперпользователь, он же может изменять состав участников той или иной группы. Члены разных групп могут иметь разные права по доступу к файлам, например, группа администраторов может иметь больше прав, чем группа программистов.</p>

<p>В индексном дескрипторе каждого файла записаны имя так называемого владельца файла и группы, которая имеет права на этот файл. Первоначально, при создании файла его владельцем объявляется тот пользователь, который этот файл создал. Точнее — тот пользователь, от чьего имени запущен процесс, создающий файл. Группа тоже назначается при создании файла — по идентификатору группы процесса, создающего файл. Владельца и группу файла можно поменять в ходе дальнейшей работы с помощью команд <code>chown</code> и <code>chgrp</code> (подробнее о них будет сказано чуть позже).</p>

<h2>Практика.</h2>

<h4>Комманда ls.</h4>

<p>Написанное в главе теория может быть понятным не сразу, потому мы перейдем к практике и разберем в примерах что и как. И для начала представлю вам команду <a href="https://ru.wikipedia.org/wiki/Ls">ls</a> с помощью этой команды можно просмотреть содержимое произвольного каталога. Если конечно у вас есть права на чтение содержимого файла/каталога, который вы хотите просмотреть. Итак, просмотрим содержимое каталога <code>/usr</code> в расширенном виде, для этого к команде <code>ls</code> добавим ключ <code>-l</code>:</p>

<p><img src="/images/posts/2015-04-14/ls-l-slash-usr.png" alt="Пример вывода команды ls" /></p>

<p>Нам необходимо обратить внимание на строку в колонке подчеркнутую <span style="color:red">красной линией</span>. Именно в этой строке команда показывает тип файла и права на него. В строке подчернутой <span style="color:green">зеленой линией</span>, показан владелец файла/каталога. Теперь подробнее разберем значения в строке подчернутой <span style="color:red">красной линией</span>. Первый символ в строке указывает <em>тип файла:</em> (-) - обычный файл, (d) - директория, (c) - файл символьного устройства, (b) - файл блочного устройства, (s) - файл локального сокета, (p) - именованный канал, (l) - символьная ссылка. Идущие следом девять символов логически делятся на <em>три группы</em> по <em>три символа</em> в каждой. <em>Первая группа</em> показывает права владельца файла, <em>вторая группа</em> - группу пользователей имеющих доступ к файлу, <em>третья группа</em> - показывает права всех остальных не вошедших в первые две группы. Для наглядности ниже приведено изображение.</p>

<p><img src="/images/posts/2015-04-14/rwx.png" alt="Пояснения значений прав" /></p>

<p>Желающие посмотреть весь список возможных ключей, могут набрать команду с ключом <code>--help</code>.</p>

<h4>Комманда chmod.</h4>

<p>Настало время научится менять права файлов и каталогов, в этом нам поможет команда <code>chmod</code>. <strong>chmod</strong> (от англ. <em><strong>ch</strong>ange <strong>mod</strong>e</em>) — программа для изменения прав доступа к файлам и директориям. Название происходит от программы ОС Unix chmod, которая, собственно, изменяет права доступа к файлам, директориям и символическим ссылкам. Например у нас в домашнем каталоге имеется файл <em>file.txt</em>:</p>

<pre><code>ls -l ~/
итого 4
-rwxr-xr-x 1 nihi1ist nihi1ist 5 дек  1 20:43 file.txt
</code></pre>

<p>Как мы видим, у владельца есть права на чтение и запись, у группы и остальных есть право только на чтение файла. Дадим полные права владельце и группе, а пользователей не являющихся владельцем и не входящих в группу мы лишим прав вообще:</p>

<pre><code>chmod 700 ~/file.txt
</code></pre>

<p>Пример — значение права «755»</p>

<table>
<thead>
<tr>
<th style="text-align:center;"> Пример — значение права «755» </th>
<th style="text-align:center;"> владелец </th>
<th style="text-align:center;"> группа </th>
<th style="text-align:center;"> остальные </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;"> восьмеричное значение         </td>
<td style="text-align:center;"> 7        </td>
<td style="text-align:center;"> 5      </td>
<td style="text-align:center;"> 5         </td>
</tr>
<tr>
<td style="text-align:center;"> символьная запись             </td>
<td style="text-align:center;"> rwx      </td>
<td style="text-align:center;"> r-x    </td>
<td style="text-align:center;"> r-x       </td>
</tr>
<tr>
<td style="text-align:center;"> обозначение типа пользователя </td>
<td style="text-align:center;"> u        </td>
<td style="text-align:center;"> g      </td>
<td style="text-align:center;"> o         </td>
</tr>
</tbody>
</table>


<p>Три варианта записи прав пользователя</p>

<table>
<thead>
<tr>
<th style="text-align:center;">  Двоичная </th>
<th style="text-align:center;"> Восьмеричная </th>
<th style="text-align:center;"> Символьная </th>
<th style="text-align:center;"> Права на файл </th>
<th style="text-align:center;"> Права на директорию </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;"> 000 </td>
<td style="text-align:center;"> 0 </td>
<td style="text-align:center;"> --- </td>
<td style="text-align:center;"> Нет </td>
<td style="text-align:center;"> Нет </td>
</tr>
<tr>
<td style="text-align:center;"> 001 </td>
<td style="text-align:center;"> 1 </td>
<td style="text-align:center;"> --x </td>
<td style="text-align:center;"> Выполнение </td>
<td style="text-align:center;"> Чтение файлов и их свойств </td>
</tr>
<tr>
<td style="text-align:center;"> 010 </td>
<td style="text-align:center;"> 2 </td>
<td style="text-align:center;"> -w- </td>
<td style="text-align:center;"> Запись </td>
<td style="text-align:center;"> Нет </td>
</tr>
<tr>
<td style="text-align:center;"> 011 </td>
<td style="text-align:center;"> 3 </td>
<td style="text-align:center;"> -wx </td>
<td style="text-align:center;"> Запись и выполнение </td>
<td style="text-align:center;"> Всё, кроме чтения списка файлов </td>
</tr>
<tr>
<td style="text-align:center;"> 100 </td>
<td style="text-align:center;"> 4 </td>
<td style="text-align:center;"> r-- </td>
<td style="text-align:center;"> Чтение </td>
<td style="text-align:center;"> Чтение имён файлов </td>
</tr>
<tr>
<td style="text-align:center;"> 101 </td>
<td style="text-align:center;"> 5 </td>
<td style="text-align:center;"> r-x </td>
<td style="text-align:center;"> Чтение и выполнение </td>
<td style="text-align:center;"> Доступ на чтение </td>
</tr>
<tr>
<td style="text-align:center;"> 110 </td>
<td style="text-align:center;"> 6 </td>
<td style="text-align:center;"> rw- </td>
<td style="text-align:center;"> Чтение и запись </td>
<td style="text-align:center;"> Чтение имён файлов </td>
</tr>
<tr>
<td style="text-align:center;"> 111 </td>
<td style="text-align:center;"> 7 </td>
<td style="text-align:center;"> rwx </td>
<td style="text-align:center;"> Все права </td>
<td style="text-align:center;"> Все права </td>
</tr>
</tbody>
</table>


<p>References определяют пользователей, которым будут меняться права. References определяются одной или несколькими буквами:</p>

<table>
<thead>
<tr>
<th> Reference </th>
<th> Class  </th>
<th> Описание                                        </th>
</tr>
</thead>
<tbody>
<tr>
<td> u         </td>
<td> user   </td>
<td> Владелец файла                                  </td>
</tr>
<tr>
<td> g         </td>
<td> group  </td>
<td> Пользователи, входящие в группу владельца файла </td>
</tr>
<tr>
<td> o         </td>
<td> others </td>
<td> Остальные пользователи                          </td>
</tr>
<tr>
<td> a         </td>
<td> all    </td>
<td> Все пользователи (или ugo)                      </td>
</tr>
</tbody>
</table>


<p>Operator определяет операцию, которую будет выполнять chmod:</p>

<table>
<thead>
<tr>
<th> Operator </th>
<th> Описание                      </th>
</tr>
</thead>
<tbody>
<tr>
<td> +        </td>
<td> добавить определенные права   </td>
</tr>
<tr>
<td> -        </td>
<td> удалить определенные права    </td>
</tr>
<tr>
<td> =        </td>
<td> установить определенные права </td>
</tr>
</tbody>
</table>


<p>Modes определяет какие именно права будут установлены, добавлены или удалены:</p>

<table>
<thead>
<tr>
<th> Mode </th>
<th> Name            </th>
<th> Описание                                                                                                                        </th>
</tr>
</thead>
<tbody>
<tr>
<td> r    </td>
<td> read            </td>
<td> чтение файла или содержимого каталога                                                                                           </td>
</tr>
<tr>
<td> w    </td>
<td> write           </td>
<td> запись в файл или в каталог                                                                                                     </td>
</tr>
<tr>
<td> x    </td>
<td> execute         </td>
<td> выполнение файла или чтение содержимого каталога                                                                                </td>
</tr>
<tr>
<td> X    </td>
<td> special execute </td>
<td> выполнение, если файл является каталогом или уже имеет право на выполнение для какого-нибудь пользователя                       </td>
</tr>
<tr>
<td> s    </td>
<td> setuid/gid      </td>
<td> установленные атрибуты SUID или SGID позволяют запускать файл на выполнение с правами владельца файла или группы соответственно </td>
</tr>
<tr>
<td> t    </td>
<td> sticky          </td>
<td> устанавливая t-бит на директорию, мы меняем это правило таким образом, что удалить файл может только владелец этого файла       </td>
</tr>
</tbody>
</table>

]]></content>
  </entry>
  
</feed>
